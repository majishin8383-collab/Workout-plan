<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Heavy Duty Log</title>

  <script>
    // cache-buster build tag (update when you change files)
    window.__BUILD__ = "HD-004";
  </script>

  <link rel="stylesheet" href="styles.css?v=HD-004" />
</head>
<body>
  <div class="wrap">
    <h1>
      Heavy Duty Log
      <span class="pill" id="nextDayPill">Next: Day A</span>
      <span class="pill" id="nutritionPill">Nutrition: 0/2 shakes</span>
    </h1>

    <div class="grid">
      <!-- LEFT -->
      <div class="card">
        <div class="row" style="justify-content:space-between;">
          <div class="small muted">Auto-fill last. Auto-progress suggestions. Cadence coach (4 down / 2 up).</div>
          <button id="btnSettings" title="Settings">⚙️</button>
        </div>

        <div class="tabs">
          <button class="tabbtn active" data-tab="plan">Plan</button>
          <button class="tabbtn" data-tab="entry">Entry</button>
          <button class="tabbtn" data-tab="nutrition">Nutrition</button>
          <button class="tabbtn" data-tab="growth">Growth</button>
        </div>

        <!-- TAB: PLAN -->
        <div id="tab_plan" style="margin-top:12px;">
          <div class="card">
            <div class="row">
              <div style="flex: 1 1 160px;">
                <label for="daySelectPlan">Preview Day</label>
                <select id="daySelectPlan">
                  <option value="A">Day A — Chest & Back</option>
                  <option value="B">Day B — Legs</option>
                  <option value="C">Day C — Delts & Arms</option>
                </select>
              </div>
              <div style="flex: 1 1 180px;">
                <label>Recovery Gate</label>
                <div class="small muted">Wait 3–4+ days as needed. Train when soreness is gone + spine feels quiet.</div>
              </div>
            </div>

            <div class="hr"></div>

            <div class="row">
              <div style="flex:1 1 auto;">
                <strong id="planTitle">Plan — Day A (Chest & Back)</strong>
                <ul id="planList" class="small muted" style="margin:8px 0 0; padding-left:18px;"></ul>
              </div>
            </div>
          </div>

          <div class="mini" style="margin-top:12px;">
            <div class="small muted">
              PR logic: beat the last entry for the same exercise/day (reps at same weight or weight at same reps).
              “Clean/controlled” unlocks progression suggestions.
            </div>
          </div>
        </div>

        <!-- TAB: ENTRY -->
        <div id="tab_entry" class="hidden" style="margin-top:12px;">
          <div class="card">
            <div class="row">
              <div style="flex: 1 1 120px;">
                <label for="daySelect">Day</label>
                <select id="daySelect">
                  <option value="A">Day A — Chest & Back</option>
                  <option value="B">Day B — Legs</option>
                  <option value="C">Day C — Delts & Arms</option>
                </select>
              </div>
              <div style="flex: 1 1 160px;">
                <label for="dateInput">Date</label>
                <input id="dateInput" type="date" />
              </div>
            </div>

            <div style="margin-top:10px;">
              <label for="exerciseSelect">Exercise</label>
              <select id="exerciseSelect"></select>
            </div>

            <!-- Auto-fill + suggestion panel -->
            <div class="mini" style="margin-top:10px;">
              <div class="row">
                <span class="badge" id="lastBadge">Last: —</span>
                <span class="badge ok" id="targetBadge">Target: —</span>
                <span class="badge warn" id="nextBadge">Next (if clean max): —</span>
              </div>
              <div class="small muted" style="margin-top:6px;">
                Auto-fills your last result. If you hit the top of the rep range <b>clean</b>, it suggests the next weight automatically.
              </div>
              <div class="row" style="margin-top:8px;">
                <button id="btnApplySuggested">Apply suggested target</button>
                <button id="btnUseLast">Load last</button>
              </div>
            </div>

            <div class="row" style="margin-top:10px;">
              <div style="flex: 1 1 120px;">
                <label for="weightInput">Weight</label>
                <input id="weightInput" inputmode="decimal" placeholder="e.g., 133" />
              </div>
              <div style="flex: 1 1 120px;">
                <label for="repsInput">Reps</label>
                <input id="repsInput" inputmode="numeric" placeholder="e.g., 2" />
              </div>
              <div style="flex: 1 1 140px;">
                <label for="unitsSelect">Units</label>
                <select id="unitsSelect">
                  <option value="lb">lb</option>
                  <option value="kg">kg</option>
                  <option value="bw">bw</option>
                  <option value="bw+">bw+</option>
                </select>
              </div>
            </div>

            <div class="row" style="margin-top:10px;">
              <label class="pill" style="margin:0;">
                <input type="checkbox" id="chkClean" />
                Clean + controlled (no cheat reps)
              </label>
              <span class="right small muted" id="lastComparison"></span>
            </div>

            <!-- Cadence coach -->
            <div class="mini" style="margin-top:10px;">
              <strong>Cadence Coach</strong>
              <div class="small muted" style="margin-top:6px;">
                Tap Start and follow the cues: <b>4 seconds down</b>, <b>2 seconds up</b>, rep counted for you.
                (Uses beep + vibration. Turn media volume up.)
              </div>

              <div class="row" style="margin-top:10px;">
                <div style="flex: 1 1 120px;">
                  <label for="cadDown">Down (sec)</label>
                  <input id="cadDown" inputmode="numeric" value="4" />
                </div>
                <div style="flex: 1 1 120px;">
                  <label for="cadUp">Up (sec)</label>
                  <input id="cadUp" inputmode="numeric" value="2" />
                </div>
                <div style="flex: 1 1 140px;">
                  <label for="cadReps">Reps to cue</label>
                  <input id="cadReps" inputmode="numeric" value="8" />
                </div>
              </div>

              <div class="row" style="margin-top:10px;">
                <button class="primary" id="btnCadStart">Start</button>
                <button id="btnCadStop">Stop</button>
                <span class="right mono" id="cadStatus">Idle</span>
              </div>
            </div>

            <div style="margin-top:10px;">
              <label for="notesInput">Notes (optional)</label>
              <textarea id="notesInput" placeholder="e.g., clean reps, no back tightness"></textarea>
            </div>

            <div class="row" style="margin-top:10px;">
              <button class="primary" id="btnAdd">Add to Log</button>
              <button id="btnQuickLast">Use last entry</button>
            </div>

            <div class="toast" id="toast"></div>
          </div>
        </div>

        <!-- TAB: NUTRITION -->
        <div id="tab_nutrition" class="hidden" style="margin-top:12px;">
          <div class="card">
            <strong>Targets (TRT + Heavy Duty + “I hate eating”)</strong>
            <div class="small muted" style="margin-top:6px;">
              Keep 2 meals/day. Add shakes to hit protein and calories without chewing.
            </div>

            <div class="kpi" style="margin-top:10px;">
              <div class="box">
                <div class="small muted">Calories</div>
                <div class="big">2,250–2,350</div>
                <div class="small muted">Adjust +150 only after 21 days flat.</div>
              </div>
              <div class="box">
                <div class="small muted">Protein</div>
                <div class="big">150–170 g</div>
                <div class="small muted">Two meals + 1–2 shakes.</div>
              </div>
              <div class="box">
                <div class="small muted">Carbs</div>
                <div class="big">180–220 g</div>
                <div class="small muted">Supports training performance.</div>
              </div>
              <div class="box">
                <div class="small muted">Fat</div>
                <div class="big">70–85 g</div>
                <div class="small muted">Joints + health + satiety.</div>
              </div>
            </div>

            <div class="hr"></div>

            <strong>Daily checklist</strong>
            <div class="row" style="margin-top:8px;">
              <label class="pill"><input type="checkbox" id="chkMeal1" /> Meal 1</label>
              <label class="pill"><input type="checkbox" id="chkMeal2" /> Meal 2</label>
              <label class="pill"><input type="checkbox" id="chkShake1" /> Shake #1 (Muscle Milk Pro 50)</label>
              <label class="pill"><input type="checkbox" id="chkShake2" /> Shake #2 (training/low appetite)</label>
              <label class="pill"><input type="checkbox" id="chkCreatine" /> Creatine</label>
              <label class="pill"><input type="checkbox" id="chkWater" /> Water</label>
            </div>

            <div class="row" style="margin-top:10px;">
              <button class="primary" id="btnSaveDaily">Save today</button>
              <button id="btnResetDaily">Reset today</button>
              <span class="right small muted" id="dailySavedText"></span>
            </div>

            <div class="hr"></div>

            <strong>Weekly weigh-in</strong>
            <div class="small muted">Once per week, same conditions (morning, after bathroom, before food).</div>

            <div class="row" style="margin-top:10px;">
              <div style="flex: 1 1 160px;">
                <label for="weighDate">Date</label>
                <input id="weighDate" type="date" />
              </div>
              <div style="flex: 1 1 160px;">
                <label for="weighValue">Bodyweight</label>
                <input id="weighValue" inputmode="decimal" placeholder="e.g., 160.4" />
              </div>
              <div style="flex: 1 1 200px;">
                <label for="weighNote">Note (optional)</label>
                <input id="weighNote" placeholder="sleep ok, appetite low, joints quiet" />
              </div>
              <div style="flex: 1 1 120px;">
                <label>&nbsp;</label>
                <button class="primary" id="btnAddWeigh">Add</button>
              </div>
            </div>

            <div style="margin-top:10px; overflow:auto;">
              <table>
                <thead>
                  <tr>
                    <th style="width:120px;">Date</th>
                    <th style="width:120px;">Weight</th>
                    <th>Note</th>
                    <th style="width:90px;">Action</th>
                  </tr>
                </thead>
                <tbody id="weighBody"></tbody>
              </table>
            </div>

            <div class="small muted" style="margin-top:10px;">
              Goal trend: ~0.5–1.0 lb/week. If flat 3 weeks → add 1 extra shake on training days.
            </div>
          </div>
        </div>

        <!-- TAB: GROWTH -->
        <div id="tab_growth" class="hidden" style="margin-top:12px;">
          <div class="card">
            <strong>Natural TRT Growth Timeline (12 months)</strong>
            <div class="small muted" style="margin-top:6px;">
              You’re ~2 months in. Do the basics perfectly and let it compound.
            </div>

            <div class="hr"></div>
            <div><strong>Months 0–2 (now)</strong><div class="small muted">Stabilizing. Strength leads size. Lock rotation + shakes + weigh-ins.</div></div>
            <div class="hr"></div>
            <div><strong>Months 3–4</strong><div class="small muted">Fullness begins. Weight: +2–4 lb. PRs = bar speed + rep quality.</div></div>
            <div class="hr"></div>
            <div><strong>Months 5–6</strong><div class="small muted">First “it’s working” phase. Weight: +5–8 lb total. Shirts fit different.</div></div>
            <div class="hr"></div>
            <div><strong>Months 7–9</strong><div class="small muted">Density phase. Tendons catch up. Don’t increase frequency.</div></div>
            <div class="hr"></div>
            <div><strong>Months 10–12</strong><div class="small muted">Decision point: only consider “extras” if compliance is perfect and recovery is limiting.</div></div>
          </div>
        </div>

        <!-- SETTINGS -->
        <div class="card hidden" id="settingsPanel" style="margin-top:12px;">
          <div class="row" style="justify-content:space-between;">
            <strong>Settings</strong>
            <button id="btnCloseSettings">✕</button>
          </div>

          <div class="row" style="margin-top:10px;">
            <button id="btnExport">Export Lift Log CSV</button>
            <button id="btnExportWeigh">Export Weigh-ins CSV</button>
            <button class="danger" id="btnClear">Clear Lift Log</button>
            <button class="danger" id="btnClearWeigh">Clear Weigh-ins</button>
          </div>

          <div class="small muted" style="margin-top:10px;">
            Data is stored locally in your browser (localStorage). Export CSV for backup.
          </div>
        </div>
      </div>

      <!-- RIGHT: LOG -->
      <div class="card">
        <div class="row">
          <strong>Lift Log</strong>
          <span class="right small muted" id="logCount"></span>
        </div>

        <div class="row" style="margin-top:10px;">
          <input id="searchInput" placeholder="Search (exercise, notes, day)…" style="flex:1 1 auto;" />
          <button id="btnToday">Today</button>
          <button id="btnDeleteLast" class="danger" title="Delete last entry">Delete last</button>
        </div>

        <div style="margin-top:10px; overflow:auto;">
          <table>
            <thead>
              <tr>
                <th style="width:110px;">Date</th>
                <th style="width:60px;">Day</th>
                <th>Exercise</th>
                <th style="width:160px;">Result</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody id="logBody"></tbody>
          </table>
        </div>

        <div class="small muted" style="margin-top:10px;">
          Tip: Mark “Clean + controlled” when you truly earned it — that’s what triggers progression suggestions.
        </div>
      </div>
    </div>
  </div>

  <script src="app.js?v=HD-004"></script>
</body>
</html>
